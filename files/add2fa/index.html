<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add 2fa method</title>

    <script type="module" src="/sdk/auth.js"></script>
    <script type="module" src="/add2fa/index.js"></script>
    <script
      type="module"
      src="/sdk/templates.js"
      data-template_debug=""
    ></script>
  </head>

  <body>
    <div
      data-template="custom"
      data-template_insert="display"
      data-template_fallback="block"
      data-template_var="addDisplay"
    >
      <button onclick="window.auth.logout().then(() => window.auth.login())">
        Re login
      </button>
      <br />
      <br />
      <input type="tel" id="phoneNumber" placeholder="Phone number" />
      <input
        type="text"
        id="displayName"
        placeholder="Phone custom user note"
      />
      <div id="2faRecaptchaButton"></div>

      <button
        onclick="window.doAdd2fa()"
        id="enable2faButton"
        data-template_var="addDisabled"
        data-template_insert="disabled"
        data-template_fallback="true"
        data-template="custom"
      >
        Add 2fa
      </button>
    </div>
    <div
      data-template="custom"
      data-template_insert="style"
      data-template_fallback="display: none;"
      data-template_var="verifyDisplay"
    >
      <input
        type="text"
        id="verificationCode"
        placeholder="Verification code"
      />
      <button onclick="window.doVerify2fa()" id="verify2faButton" disabled>
        Verify 2fa
      </button>
    </div>
  </body>
  <script defer>
    var addDisabled = true;
    //check if phonenumber and displayname are set
    var phoneNumber = document.getElementById("phoneNumber");
    var displayName = document.getElementById("displayName");

    function checkIfEmpty() {
      if (phoneNumber.value == "" || displayName.value == "") {
        return true;
        console.log("Not valid");
      } else {
        return false;
        console.log("Valid");
        window.replaceTemplates();
      }
    }
    //add listeners
    phoneNumber.addEventListener("input", {
      handleEvent: function (event) {
        addDisabled = checkIfEmpty();
        window.replaceTemplates();
      },
    });

    displayName.addEventListener("input", {
      handleEvent: function (event) {
        addDisabled = checkIfEmpty();
        window.replaceTemplates();
      },
    });
    var verifyDisplay = "display: none;";
    var addDisplay = "display: block;";
    window.replaceTemplates();
  </script>
</html>
