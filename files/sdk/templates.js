import{onStateChange}from"/sdk/auth.js";import{deepQuerySelectorAll}from"/common/deepQuerySelectorAll.js";const scriptOnPage=document.querySelector("script[data-template_debug]"),debug=null!==scriptOnPage;debug&&console.log("[templateSDK] Debug Mode is enabled.");const getTemplateValues=e=>({email:e?.email??"",displayName:e?.displayName??"",picture:e?.picture??"",loggedOut:null!==e,loggedIn:null===e,custom:null});export async function replaceTemplates(e){const t=getTemplateValues(e),a=deepQuerySelectorAll("[data-template]");for(const e of a){const a=e.dataset.template;if(debug&&console.log("[templateSDK] Attempting template "+a+" with value "+t[a]+"."),!(a in t)&&debug){console.error(new Error(`[templateSDK] Template ${a} not found.`));continue}let l=t[a];if([null,void 0,""].includes(l)&&void 0!==e.dataset.template_fallback&&null!==l&&(debug&&console.log(`[templateSDK] Using fallback value ${e.dataset.template_fallback} on template ${a}.`),l=e.dataset.template_fallback),[null,void 0,""].includes(l)&&void 0!==e.dataset.template_fallback_lang_text&&null!==l){debug&&console.log(`[templateSDK] Using language fallback value ${e.dataset.template_fallback_lang_text} on template ${a}.`);l=(await import("/sdk/language.js")).getMessage(e.dataset.template_fallback_lang_text)}void 0!==e.dataset.template_var&&(debug&&console.log(`[templateSDK] Using custom variable ${e.dataset.template_var} on template ${a}.`),l=window[e.dataset.template_var]),void 0!==e.dataset.template_update_callback&&(debug&&console.log(`[templateSDK] Running callback function ${e.dataset.template_update_callback} on template ${a} with value ${l}.`),window[e.dataset.template_update_callback](a,l)),void 0===e.dataset.template_insert||"innerText"===e.dataset.template_insert?(debug&&console.log(`[templateSDK] Replacing template ${a} with value ${l}.`),e.innerText=l):(debug&&(console.log(`[templateSDK] Replacing template ${a} with value ${l}.`),console.log(`[templateSDK] Using custom insert method ${e.dataset.template_insert}.`)),e[e.dataset.template_insert]=l)}if(0===a.length&&debug)throw new Error("[templateSDK] No templates found to replace. Please make sure you have at least one element with the data-template attribute.")}onStateChange((e=>{replaceTemplates(e)})),replaceTemplates(null);
