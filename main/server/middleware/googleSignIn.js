const{client_id:client_id}=require("../../../credentials/googleClientId.json"),{setCredential:setCredential}=require("../../../api/getGoogleSignInCredential.js"),{OAuth2Client:OAuth2Client}=require("google-auth-library"),client=new OAuth2Client(client_id);module.exports=async({extraData:e,parseError:t})=>{try{if(!e.body?.g_csrf_token)return;const{credential:t,clientId:i,g_csrf_token:n}=e.body,r=await client.verifyIdToken({idToken:t,audience:i}),l=r.getPayload().sub;return setCredential(n,t),{googleUserId:l}}catch(e){t(e)}};
