const sniffr=require("sniffr");module.exports={dependencies:{},execute(e,n){const s=new sniffr;s.sniff(e.headers["user-agent"]);const o=(e.headers["x-forwarded-for"]||"").split(",").pop().trim()||e.connection.remoteAddress||e.socket.remoteAddress||e.connection.socket.remoteAddress,r={};o&&(r.ip={value:o}),n&&(r.cookie=n);const t={name:"Unknown"===s.browser.name?null:s.browser.name,version:"Unknown"===s.browser.version?null:s.browser.version};(t.name||t.version)&&(r.browser=t);const i={name:"Unknown"===s.os.name?null:s.os.name,version:"Unknown"===s.os.version?null:s.os.version};(i.name||i.version)&&(r.os=i);const l={name:"Unknown"===s.device.name?null:s.device.name};l.name&&(r.device=l);const a=[],c=e.headers["accept-language"];if(c){c.split(",").forEach((e=>{const n=e.split(";")[0].split("-")[0];let s=null;e.split(";")[0].split("-").length>1&&(s=e.split(";")[0].split("-")[1]);let o=1;e.split(";").length>1&&(o=parseFloat(e.split(";")[1].split("q=")[1]));const r={name:n,quality:o};s&&(r.region=s),a.push(r)})),r.lang=a}return r}};
