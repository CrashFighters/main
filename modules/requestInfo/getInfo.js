const sniffr=require("sniffr");module.exports={dependencies:{},execute(e,n){const s=new sniffr;s.sniff(e.headers["user-agent"]);let o=(e.headers["x-forwarded-for"]||"").split(",").pop().trim()||e.connection.remoteAddress||e.socket.remoteAddress||e.connection.socket.remoteAddress,r={};o&&(r.ip={value:o}),n&&(r.cookie=n);let l={name:"Unknown"==s.browser.name?null:s.browser.name,version:"Unknown"==s.browser.version?null:s.browser.version};(l.name||l.version)&&(r.browser=l);let t={name:"Unknown"==s.os.name?null:s.os.name,version:"Unknown"==s.os.version?null:s.os.version};(t.name||t.version)&&(r.os=t);let i={name:"Unknown"==s.device.name?null:s.device.name};i.name&&(r.device=i);let a=[],p=e.headers["accept-language"];if(p){p.split(",").forEach((e=>{let n=e.split(";")[0].split("-")[0],s=null;e.split(";")[0].split("-").length>1&&(s=e.split(";")[0].split("-")[1]);let o=1;e.split(";").length>1&&(o=parseFloat(e.split(";")[1].split("q=")[1]));let r={name:n,quality:o};s&&(r.region=s),a.push(r)})),r.lang=a}return r}};
