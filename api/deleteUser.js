const firebase=require("../modules/authentication/functions/authentication.js");module.exports={async execute({end:e,middlewareData:{authentication:t},statusCode:a,parseError:i}){try{if(!t)return a(401,"unauthorized","Unauthorized");const i=firebase.auth(),n=new Date(1e3*t.auth_time);if(((new Date).getTime()-n.getTime())/1e3>300)return a(403,"oldLogin","The login is too old, login again");await i.deleteUser(t.uid),e()}catch(e){i(e)}}};
